#lang racket
(require 2htdp/image
         2htdp/universe
         lang/posn)

(define screen-height 500)
(define screen-width 500)
(define scene1 (empty-scene screen-width screen-height))

(struct point [x y] #:transparent)
(struct actor [position sprite size] #:transparent)
(struct world [actor scene] #:transparent)

(define player
  (actor
   [point 250 250]
   [square 50 'solid 'red]
   50))

(define world1
  (world player scene1))

(define (get-actor-x state)
  (point-x (actor-position (world-actor state))))

(define (get-actor-y state)
  (point-y (actor-position (world-actor state))))

(define (get-actor-sprite state)
  (actor-sprite (world-actor state)))

(define (get-actor-size state)
  (actor-size (world-actor state)))


(define (key-handler state a-key)
  (let ([speed 10.0])
    (cond
      [(and (key=? a-key "left")
            ;; Check if in bounds
            (>
             (- (get-actor-x state)(/ (get-actor-size state) 2)) 0))
       (struct-copy world state
                    [actor (struct-copy actor state
                                        [position (struct-copy point state
                                                               [x (- (get-actor-x state) 1)])])])])))


       
(define (draw state)
  (place-images
   (list
    (actor-sprite (world-actor state))
    (text "test" 20 'black))
   (list
    (make-posn
     (get-actor-x state)
     (get-actor-y state))
    (make-posn 450 50))
   (world-scene state)))

(define (update state)
  state)

(big-bang world1
  (on-tick update)
  (to-draw draw)
  (on-key key-handler))